<!DOCTYPE html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>XR Training Labs | Persistent Expansion</title> 
    
    <link rel="preconnect" href="https://fonts.googleapis.com"> 
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Source+Code+Pro&display=swap" rel="stylesheet"> 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script> 
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/handtrackjs/dist/handtrack.min.js"></script> 

    <style> 
        :root { 
            --bg-color: #030508; 
            --text-color: #ffffff; 
            --accent-color: #6366f1; 
            --hud-green: #4ade80; 
            --model-bg: #111418; 
            --glass-border: rgba(255, 255, 255, 0.1); 
            --grid-color: rgba(99, 102, 241, 0.12); 
            --error-red: #ff4444; 
        } 

        * { margin: 0; padding: 0; box-sizing: border-box; } 
        
        body { font-family: 'Inter', sans-serif; background: var(--bg-color); color: var(--text-color); overflow-x: hidden; } 

        #parallax-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at center, #0a0c14 0%, #030508 100%); overflow: hidden; } 
        .parallax-layer { position: absolute; top: -10%; left: -10%; width: 120%; height: 120%; will-change: transform; } 
        #grid-layer { background-image: linear-gradient(var(--grid-color) 1px, transparent 1px), linear-gradient(90deg, var(--grid-color) 1px, transparent 1px); background-size: 60px 60px; mask-image: radial-gradient(ellipse at center, black, transparent 85%); } 
        #particle-canvas { width: 100%; height: 100%; } 

        nav { position: fixed; top: 0; width: 100%; padding: 20px 5%; display: flex; justify-content: space-between; z-index: 1000; backdrop-filter: blur(10px); border-bottom: 1px solid var(--glass-border); } 
        .logo { font-weight: 700; font-family: 'Source Code Pro', monospace; color: var(--accent-color); font-size: 1rem; } 

        section { padding: 140px 5% 60px; min-height: 90vh; display: flex; flex-direction: column; justify-content: center; position: relative; z-index: 10; } 
        h1 { font-size: clamp(2.5rem, 8vw, 5rem); font-weight: 700; line-height: 1; margin-bottom: 10px; text-transform: uppercase; letter-spacing: -2px; } 
        h2.sub-heading { font-size: clamp(1.2rem, 3vw, 2rem); font-weight: 300; color: var(--accent-color); margin-bottom: 25px; text-transform: uppercase; letter-spacing: 2px; } 
        .intro-text { font-size: 1.1rem; color: #aaa; max-width: 800px; line-height: 1.6; margin-bottom: 40px; text-align: justify; hyphens: auto; } 
        .ar-content { margin-bottom: 20px; display: inline-block; padding: 5px 15px; border-left: 3px solid var(--accent-color); background: rgba(99, 102, 241, 0.05); font-family: 'Source Code Pro', monospace; font-size: 0.8rem; } 

        /* --- VIDEO GRID TILT RESTORED --- */ 
        .grid-container { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; max-width: 1600px; margin: 20px auto; perspective: 2000px; } 
        @media (max-width: 1100px) { .grid-container { grid-template-columns: repeat(2, 1fr); } } 
        @media (max-width: 600px) { .grid-container { grid-template-columns: 1fr; } } 

        .video-card {  
            position: relative; width: 100%; aspect-ratio: 16/9; border-radius: 10px; overflow: hidden;  
            background: #000; border: 1px solid var(--glass-border); cursor: pointer; transform-style: preserve-3d; 
            transition: z-index 0.3s; 
        } 
        .shine { position: absolute; top: 0; left: 0; width: 150%; height: 150%; background: radial-gradient(circle, rgba(255,255,255,0.18) 0%, rgba(255,255,255,0) 70%); pointer-events: none; z-index: 5; opacity: 0; transform: translate(-50%, -50%); } 
        .video-card iframe { width: 100%; height: 100%; border: 0; pointer-events: none; transform: scale(1.02); } 

        /* --- IPHONE WRAPPER --- */
        .iphone-wrapper { display: flex; justify-content: center; padding: 60px 0; } 
        .iphone-device { width: 320px; height: 650px; background: #111; border-radius: 40px; border: 8px solid #222; position: relative; box-shadow: 0 50px 100px rgba(0,0,0,0.8); overflow: hidden; } 
        .iphone-device::before { content: ''; position: absolute; top: 15px; left: 50%; transform: translateX(-50%); width: 100px; height: 25px; background: #000; border-radius: 20px; z-index: 20; } 
        .iphone-screen { width: 100%; height: 100%; background: #000; } 
        .iphone-screen iframe { width: 100%; height: 100%; border: none; } 

        /* --- ORIGINAL FULL-WINDOW CHINOOK LAYOUT --- */ 
        .spatial-sync-wrapper { 
            display: flex; 
            width: 100%; 
            max-width: 1600px; 
            margin: 30px auto; 
            gap: 30px; 
            align-items: center; /* Center Vertically */
            justify-content: center; /* Center Horizontally */
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1); 
        } 
        .model-card { 
            width: 100%; 
            height: 75vh; 
            background: var(--model-bg); 
            border-radius: 24px; 
            border: 1px solid var(--glass-border); 
            position: relative; 
            overflow: hidden; 
            box-shadow: 0 30px 60px rgba(0,0,0,0.4); 
            flex-shrink: 0; 
        } 
        .spatial-sync-wrapper.tracking-active .model-card { 
            width: 66%; 
        } 

        #preview-wrapper { 
            width: 33%; 
            height: 60vh; 
            border-radius: 24px; 
            overflow: hidden; 
            border: 1px solid var(--accent-color); 
            background: #000; 
            display: none; 
        } 
        #v-preview { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); } 

        #tech-hud { position: absolute; top: 25px; left: 25px; padding: 20px; background: rgba(5, 7, 10, 0.9); border: 1px solid var(--hud-green); color: var(--hud-green); font-family: 'Source Code Pro', monospace; font-size: 0.7rem; opacity: 0; transition: 0.4s; z-index: 5; pointer-events: none; } 
        #tech-hud.active { opacity: 1; } 
        #hand-ui { margin-bottom: 20px; } 
        .cam-btn { background: var(--accent-color); color: #fff; border: none; padding: 14px 28px; border-radius: 4px; font-weight: 700; cursor: pointer; text-transform: uppercase; font-family: 'Source Code Pro', monospace; transition: 0.3s; } 
    </style> 
</head> 
<body> 

    <div id="parallax-container"> 
        <div id="grid-layer" class="parallax-layer"></div> 
        <div id="particle-layer" class="parallax-layer"><canvas id="particle-canvas"></canvas></div> 
    </div> 

    <nav><div class="logo">XR_TRAINING_LABS_v2.0</div></nav> 

    <section> 
        <h1>XR Training Labs</h1> 
        <h2 class="sub-heading">Spatial Computing Training Systems</h2> 
        <p class="intro-text"> 
            Spatial Computing Training Systems leverage augmented reality and computer vision to bridge the gap between theoretical knowledge and practical application. We have experience in designing, developing and deployment of training in 3d, mixed and virtual reality, using Moodle, Web, Apps and VR headsets.
        </p>

        <div class="ar-content">DIAGNOSTIC_RECORDS // VIDEO_LIBRARY</div> 
         
        <div class="grid-container"> 
            <div class="video-card" data-video="_ckPvnl4HQI"><div class="shine"></div><iframe src="https://www.youtube.com/embed/_ckPvnl4HQI?controls=0&mute=1&enablejsapi=1"></iframe></div> 
            <div class="video-card" data-video="2OvfLt13D6Y"><div class="shine"></div><iframe src="https://www.youtube.com/embed/2OvfLt13D6Y?controls=0&mute=1&enablejsapi=1"></iframe></div> 
            <div class="video-card" data-video="8kNXOVutOJc"><div class="shine"></div><iframe src="https://www.youtube.com/embed/8kNXOVutOJc?controls=0&mute=1&enablejsapi=1"></iframe></div> 
            <div class="video-card" data-video="0m-LbA8E97Q"><div class="shine"></div><iframe src="https://www.youtube.com/embed/0m-LbA8E97Q?controls=0&mute=1&enablejsapi=1"></iframe></div> 
            <div class="video-card" data-video="DfQ2xc5ygGc"><div class="shine"></div><iframe src="https://www.youtube.com/embed/DfQ2xc5ygGc?controls=0&mute=1&enablejsapi=1"></iframe></div> 
            <div class="video-card" data-video="LvSaP_7rMbM"><div class="shine"></div><iframe src="https://www.youtube.com/embed/LvSaP_7rMbM?controls=0&mute=1&enablejsapi=1"></iframe></div> 
            <div class="video-card" data-video="hwnwM5zI8To"><div class="shine"></div><iframe src="https://www.youtube.com/embed/hwnwM5zI8To?controls=0&mute=1&enablejsapi=1"></iframe></div> 
            <div class="video-card" data-video="inC-Lab04aA"><div class="shine"></div><iframe src="https://www.youtube.com/embed/inC-Lab04aA?controls=0&mute=1&enablejsapi=1"></iframe></div> 
        </div> 

        <div class="ar-content" style="margin-top: 60px;">MOBILE_INTERFACE: AERO_ASSET_VIEWER</div>
        <div class="iphone-wrapper">
            <div class="iphone-device">
                <div class="iphone-screen">
                    <iframe srcdoc="
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <script type='module' src='https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js'></script>
                            <style>
                                body { margin: 0; background: #0d1117; color: white; font-family: sans-serif; height: 100vh; overflow: hidden; }
                                #start-screen { position: fixed; inset: 0; background: radial-gradient(circle, #1a202c, #0d1117); z-index: 100; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: 0.5s; }
                                .commence-btn { border: 1px solid white; background: none; color: white; padding: 10px 20px; cursor: pointer; margin-top: 20px; }
                                .control-panel { position: absolute; top: 50px; left: 10px; right: 10px; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; backdrop-filter: blur(10px); z-index: 50; display: flex; justify-content: space-between; }
                                select { background: transparent; color: white; border: none; width: 70%; outline: none; }
                                .details-panel { position: absolute; inset: 0; background: #0a0f19; transform: translateX(100%); transition: 0.4s; z-index: 200; padding: 60px 20px; box-sizing: border-box; overflow-y: auto;}
                                .details-panel.active { transform: translateX(0); }
                                model-viewer { width: 100%; height: 100%; }
                                .spec-item { border-top: 1px solid rgba(255,255,255,0.1); padding: 8px 0; font-size: 11px; }
                                .label { color: #63b3ed; font-size: 9px; text-transform: uppercase; display: block; }
                            </style>
                        </head>
                        <body>
                            <div id='start-screen'><h2>AERO ASSET</h2><button class='commence-btn' onclick='this.parentElement.style.opacity=0;setTimeout(()=>this.parentElement.style.display=&quot;none&quot;,500)'>START</button></div>
                            <div id='details' class='details-panel'>
                                <h3 id='t'>Asset</h3>
                                <div id='specs'></div>
                                <button onclick='document.getElementById(&quot;details&quot;).classList.remove(&quot;active&quot;)' style='width:100%; margin-top:20px; background:none; border:1px solid white; color:white; padding:10px;'>CLOSE</button>
                            </div>
                            <div class='control-panel'>
                                <select id='s' onchange='u(this.value)'></select>
                                <button onclick='document.getElementById(&quot;details&quot;).classList.add(&quot;active&quot;)' style='background:#5d7a8c; color:white; border:none; padding:5px 10px; border-radius:4px; font-size:10px;'>FACTS</button>
                            </div>
                            <model-viewer id='m' camera-controls auto-rotate shadow-intensity='2'></model-viewer>
                            <script>
                                /* RELATIVE PATHS FOR IPHONE WINDOW */
                                const d = [
                                    { n: 'Airbus A319', f: 'models/airbus_a319.glb', cat: '6', p: '160', fuel: '23,860 L', haz: 'Oxygen, Li-ion', rescue: '4 Main exits' },
                                    { n: 'Airbus A320', f: 'models/airbus_a320.glb', cat: '6', p: '180', fuel: '24,210 L', haz: 'Composite Dust', rescue: '4 Main exits, 4 Overwing' },
                                    { n: 'Airbus A321', f: 'models/airbus_a321.glb', cat: '7', p: '236', fuel: '29,680 L', haz: 'Cryo Cooling', rescue: '8 exits' },
                                    { n: 'Airbus A380', f: 'models/airbus_a380.glb', cat: '10', p: '853', fuel: '320,000 L', haz: 'Massive Fuel', rescue: '16 Floor-level exits' },
                                    { n: 'CH-47 Chinook', f: 'models/chinook-2.glb', cat: 'Tactical', p: '33', fuel: '3,914 L', haz: 'Military Spec', rescue: 'Rear ramp' }
                                ];
                                const sel = document.getElementById('s');
                                d.forEach((x, i) => { const o = document.createElement('option'); o.value = i; o.innerText = x.n; sel.appendChild(o); });
                                function u(i) {
                                    const a = d[i];
                                    document.getElementById('m').src = '../' + a.f;
                                    document.getElementById('t').innerText = a.n;
                                    document.getElementById('specs').innerHTML = `
                                        <div class='spec-item'><span class='label'>ICAO ARFF CAT</span>` + a.cat + `</div>
                                        <div class='spec-item'><span class='label'>MAX PAX</span>` + a.p + `</div>
                                        <div class='spec-item'><span class='label'>FUEL LOAD</span>` + a.fuel + `</div>
                                        <div class='spec-item'><span class='label'>CIVILIAN HAZARDS</span>` + a.haz + `</div>
                                    `;
                                }
                                u(0);
                            </script>
                        </body>
                        </html>
                    "></iframe>
                </div>
            </div>
        </div>

        <p class="intro-text" style="margin-top: 40px; max-width: 100%;"> 
            Team members have successfully built and deployed training for the UK Military. We offer a single point of contact to bring your training to life with Virtual reality, Mixed reality and 3D.
        </p> 
    </section> 

    <section> 
        <div class="ar-content">SPATIAL_SYNC: CHINOOK_CH47D</div> 
        <div id="hand-ui"><button class="cam-btn" id="t-btn">INITIALIZING SENSORS...</button></div> 
        <div class="spatial-sync-wrapper" id="sync-engine"> 
            <div class="model-card"> 
                <div id="tech-hud"> 
                    <div>[SYSTEM STATUS: X-RAY ACTIVE]</div> 
                    <div>---------------------------</div> 
                    <div>STRUCTURAL INTEGRITY: 98.4%</div> 
                </div> 
                <model-viewer id="xr-model" src="models/chinook-2.glb" camera-controls shadow-intensity="1" camera-orbit="0deg 75deg 12m" style="width:100%; height:100%;"></model-viewer> 
            </div> 
            <div id="preview-wrapper"><video id="v-preview" autoplay playsinline muted width="640" height="480"></video></div> 
        </div> 
    </section> 

    <script> 
        /* --- VIDEO TILT PHYSICS RESTORED --- */
        const cards = document.querySelectorAll('.video-card'); 
        cards.forEach(card => { 
            const iframe = card.querySelector('iframe'); 
            const shine = card.querySelector('.shine'); 
            const videoId = card.getAttribute('data-video'); 

            card.addEventListener('mousemove', (e) => { 
                const rect = card.getBoundingClientRect(); 
                const x = e.clientX - rect.left; 
                const y = e.clientY - rect.top; 
                const rX = ((y - rect.height/2) / (rect.height/2)) * -20; 
                const rY = ((x - rect.width/2) / (rect.width/2)) * 20; 
                gsap.to(card, { rotateX: rX, rotateY: rY, scale: 1.4, zIndex: 100, boxShadow: "0 40px 80px rgba(99, 102, 241, 0.6)", duration: 0.1 }); 
                gsap.to(shine, { opacity: 1, x: `${(x/rect.width)*100 - 50}%`, y: `${(y/rect.height)*100 - 50}%`, duration: 0.1 }); 
            }); 

            card.addEventListener('mouseenter', () => { 
                iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&enablejsapi=1`; 
                cards.forEach(other => { if(other !== card) gsap.to(other, { opacity: 0.1, scale: 0.8, filter: "blur(4px)", duration: 0.4 }); }); 
            }); 

            card.addEventListener('mouseleave', () => { 
                gsap.to(card, { rotateX: 0, rotateY: 0, scale: 1, zIndex: 1, boxShadow: "0 10px 20px rgba(0,0,0,0.4)", duration: 0.6, ease: "elastic.out(1, 0.3)" }); 
                gsap.to(shine, { opacity: 0 }); 
                iframe.src = iframe.src.replace("&autoplay=1", ""); 
                cards.forEach(other => { gsap.to(other, { opacity: 1, scale: 1, filter: "blur(0px)", duration: 0.4 }); }); 
            }); 
        });

        /* --- ORIGINAL HAND TRACKING LOGIC RESTORED --- */
        const mv = document.querySelector('#xr-model'); 
        const vTrack = document.getElementById("v-preview"); 
        const btnTrack = document.getElementById("t-btn"); 
        const previewWrapper = document.getElementById("preview-wrapper"); 
        const syncEngine = document.getElementById("sync-engine"); 
        const hud = document.getElementById("tech-hud"); 
        let isTracking = false; 
        let dModel = null; 

        handTrack.load({ flipHorizontal: true, maxNumBoxes: 1, scoreThreshold: 0.6 }).then(m => { 
            dModel = m; 
            btnTrack.innerText = "SENSORS READY"; 
            btnTrack.style.background = "var(--hud-green)"; 
        }); 

        btnTrack.addEventListener("click", () => { 
            if (!isTracking) { 
                handTrack.startVideo(vTrack).then(status => { 
                    if (status) { 
                        isTracking = true; 
                        syncEngine.classList.add('tracking-active'); 
                        previewWrapper.style.display = "block"; 
                        btnTrack.innerText = "TERMINATE SENSORS"; 
                        btnTrack.style.background = "var(--error-red)"; 
                        detectHand(); 
                    } 
                }); 
            } else { 
                handTrack.stopVideo(vTrack); 
                isTracking = false; 
                syncEngine.classList.remove('tracking-active'); 
                previewWrapper.style.display = "none"; 
                btnTrack.innerText = "INITIALIZE SENSORS"; 
                btnTrack.style.background = "var(--accent-color)"; 
            } 
        }); 

        function detectHand() { 
            if (!isTracking) return; 
            dModel.detect(vTrack).then(preds => { 
                const hand = preds.find(p => p.label !== 'face'); 
                if (hand) { 
                    const [x, y, w, h] = hand.bbox; 
                    const centerX = x + w / 2; 
                    const percentX = centerX / 640; 
                    mv.cameraOrbit = `${(percentX * 360) - 180}deg 75deg 12m`; 
                    
                    const xray = ["closed", "fist", "pinch"].includes(hand.label); 
                    hud.classList.toggle('active', xray); 
                    if (mv.model) { 
                        mv.model.materials.forEach(mat => { 
                            mat.setAlphaMode(xray ? "BLEND" : "OPAQUE"); 
                            mat.pbrMetallicRoughness.setBaseColorFactor(xray ? [0.2, 0.4, 1.0, 0.3] : [1, 1, 1, 1]); 
                        }); 
                    } 
                } 
                requestAnimationFrame(detectHand); 
            }); 
        } 

        /* --- PARALLAX BACKGROUND --- */
        const pCanvas = document.getElementById('particle-canvas'); 
        const pCtx = pCanvas.getContext('2d'); 
        let pWidth, pHeight; 
        const particles = []; 
        function resize() { pWidth = window.innerWidth; pHeight = window.innerHeight; pCanvas.width = pWidth; pCanvas.height = pHeight; } 
        class Particle { constructor() { this.reset(); } reset() { this.x = Math.random() * pWidth; this.y = Math.random() * pHeight; this.size = Math.random() * 1.5; this.speed = Math.random() * 0.4 + 0.1; this.opacity = Math.random() * 0.4 + 0.1; } update() { this.y -= this.speed; if (this.y < 0) this.reset(); } draw() { pCtx.fillStyle = `rgba(99, 102, 241, ${this.opacity})`; pCtx.beginPath(); pCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2); pCtx.fill(); } } 
        for(let i=0; i<80; i++) particles.push(new Particle()); 
        function animate() { pCtx.clearRect(0, 0, pWidth, pHeight); particles.forEach(p => { p.update(); p.draw(); }); requestAnimationFrame(animate); } 
        window.addEventListener('resize', resize); resize(); animate(); 
        
        window.addEventListener('mousemove', (e) => { 
            const moveX = (e.clientX - window.innerWidth/2) / window.innerWidth; 
            const moveY = (e.clientY - window.innerHeight/2) / window.innerHeight; 
            gsap.to('#grid-layer', { x: moveX * 45, y: moveY * 45, duration: 2.5, ease: "power2.out" }); 
            gsap.to('#particle-layer', { x: moveX * 80, y: moveY * 80, duration: 2.5, ease: "power2.out" }); 
        }); 
    </script> 
</body> 
</html>
